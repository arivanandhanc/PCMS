
"use client";
import { useEffect, useState } from "react";
import { getCartCount } from "@/lib/cart";
import Link from "next/link";
import { usePathname } from "next/navigation";

import "@/compstyles/Header.css";
import type { Header as HeaderType } from "@/contentstack/generated";

type HeaderProps = {
  header: Pick<HeaderType, "links_group">;
};


const Header = ({ header }: HeaderProps) => {
  
const pathname = usePathname();
  const [menuOpen, setMenuOpen] = useState(false);
const [count, setCount] = useState(0);
const [mounted, setMounted] = useState(false);
useEffect(() => {
    setMounted(true); // runs only on client after hydration
  }, []);

 useEffect(() => {
  if (!mounted) return;

  const update = () => setCount(getCartCount());
  update();

  window.addEventListener("cart-updated", update);
  return () => window.removeEventListener("cart-updated", update);
}, [mounted]);

  const group = header.links_group;

  // âœ… UPDATED to match CT (no link1, links is array)
  const links =
    group?.links?.filter(
      (link): link is NonNullable<typeof link> =>
        Boolean(link?.href && link?.title)
    ) ?? [];

    // âœ… cart count listener
  useEffect(() => {
    const update = () => setCount(getCartCount());
    update();

    window.addEventListener("cart-updated", update);
    return () => window.removeEventListener("cart-updated", update);
  }, []);
  return (
    <header className="cs-header">
      <div className="cs-header__logo">
        {/* SVG unchanged */}
         <svg  viewBox="0 0 1075 971" fill="none">
<path d="M337.484 284.484H546.061V345.146H346.436V346.192H343.75V347.238H342.855V348.284H341.96V350.376H341.064V506.215H341.96V508.307H342.855V509.353H343.75V510.398H347.331V511.444H546.061V571.061H529.053V572.106H341.96V571.061H334.798V570.015H331.217V568.969H327.637V567.923H324.951V566.877H322.266V565.831H320.475V564.785H318.685V563.739H316.895V562.693H315.104V561.647H314.209V560.602H312.419V559.556H310.628V558.51H309.733V557.464H308.838V556.418H307.943V555.372H307.048V554.326H306.152V553.28H305.257V552.234H304.362V551.188H303.467V550.143H302.572V549.097H301.676V548.051H300.781V545.959H299.886V544.913H298.991V543.867H298.096V541.775H297.201V539.684H296.305V537.592H295.41V535.5H294.515V532.362H293.62V529.225H292.725V526.087H291.829V520.857H290.934V512.49H290.039V342.009H290.934V333.642H291.829V328.412H292.725V325.274H293.62V323.183H294.515V320.045H295.41V317.953H296.305V315.861H297.201V313.77H298.096V311.678H298.991V310.632H299.886V309.586H300.781V307.494H301.676V306.448H302.572V305.402H303.467V304.356H304.362V303.311H305.257V302.265H306.152V301.219H307.048V300.173H307.943V299.127H308.838V298.081H309.733V297.035H311.523V295.989H312.419V294.943H314.209V293.897H315.999V292.852H316.895V291.806H319.58V290.76H320.475V289.714H323.161V288.668H325.846V287.622H327.637V286.576H331.217V285.53H337.484V284.484Z" fill="black"/>
<path d="M609.619 284.484H770.752V285.53H776.123V286.576H780.599V287.622H783.285V288.668H785.075V289.714H786.865V290.76H788.656V291.806H790.446V292.852H792.236V293.897H793.132V294.943H794.922V295.989H795.817V297.035H796.712V298.081H797.607V299.127H798.503V300.173H799.398V301.219H800.293V302.265H801.188V303.311H802.083V304.356H802.979V305.402H803.874V306.448H804.769V308.54H805.664V309.586H806.559V311.678H807.454V313.77H808.35V315.861H809.245V317.953H810.14V321.091H811.035V325.274H811.93V329.458H812.826V337.825H813.721V572.106H763.59V553.28H762.695V531.316H763.59V518.766H762.695V512.49H763.59V485.297H762.695V474.838H763.59V449.736H762.695V448.69H763.59V437.186H762.695V431.956H763.59V416.268H762.695V414.176H763.59V367.11H762.695V365.019H763.59V348.284H762.695V347.238H761.8V346.192H760.905V345.146H714.355V572.106H665.12V345.146H618.571V346.192H617.676V347.238H616.781V572.106H608.724V573.152H600.667V572.106H574.707V573.152H567.546V572.106H566.65V543.867H567.546V515.628H566.65V509.353H567.546V503.077H566.65V489.48H567.546V486.343H566.65V480.067H567.546V448.69H566.65V441.369H567.546V440.323H566.65V415.222H567.546V414.176H566.65V413.13H567.546V383.845H566.65V351.422H567.546V330.504H568.441V326.32H569.336V322.137H570.231V318.999H571.126V316.907H572.021V313.77H572.917V312.724H573.812V310.632H574.707V309.586H575.602V307.494H576.497V306.448H577.393V304.356H578.288V303.311H579.183V302.265H580.078V301.219H580.973V300.173H581.868V299.127H582.764V298.081H583.659V297.035H584.554V295.989H585.449V294.943H587.24V293.897H588.135V292.852H589.925V291.806H591.715V290.76H593.506V289.714H595.296V288.668H597.982V287.622H600.667V286.576H604.248V285.53H609.619V284.484Z" fill="black"/>
<path d="M877.279 284.484H1069.74V345.146H884.44V346.192H883.545V348.284H882.65V350.376H883.545V352.468H882.65V397.441H883.545V398.487H884.44V399.533H1028.56V400.579H1029.46V399.533H1030.35V400.579H1034.83V401.625H1038.41V402.671H1041.1V403.717H1043.78V404.763H1045.57V405.809H1047.36V406.854H1049.15V407.9H1050.94V408.946H1051.84V409.992H1053.63V411.038H1054.52V412.084H1056.32V413.13H1057.21V414.176H1058.11V415.222H1059V416.268H1059.9V417.313H1060.79V418.359H1061.69V419.405H1062.58V420.451H1063.48V421.497H1064.37V422.543H1065.27V424.635H1066.16V425.681H1067.06V427.772H1067.95V428.818H1068.85V430.91H1069.74V433.002H1070.64V435.094H1071.53V438.231H1072.43V441.369H1073.32V446.599H1074.22V453.92H1075.11V460.195H1074.22V519.812H1073.32V526.087H1072.43V530.271H1071.53V533.408H1070.64V535.5H1069.74V538.638H1068.85V540.729H1067.95V541.775H1067.06V543.867H1066.16V544.913H1065.27V547.005H1064.37V548.051H1063.48V550.143H1062.58V551.188H1061.69V552.234H1060.79V553.28H1059.9V554.326H1059V555.372H1058.11V556.418H1057.21V557.464H1056.32V558.51H1054.52V559.556H1053.63V560.602H1052.73V561.647H1050.94V562.693H1049.15V563.739H1048.26V564.785H1046.47V565.831H1044.68V566.877H1041.99V567.923H1040.2V568.969H1036.62V570.015H1033.04V571.061H1027.67V572.106H1026.77V571.061H1024.98V572.106H833.415V513.536H834.31V512.49H889.811V513.536H893.392V512.49H896.973V513.536H910.4V512.49H918.457V513.536H919.352V512.49H958.74V513.536H978.434V512.49H1023.19V511.444H1024.09V509.353H1024.98V481.113H1024.09V458.104H1024.98V457.058H1024.09V454.966H1023.19V453.92H874.593V452.874H870.117V451.828H867.432V450.782H864.746V449.736H862.061V448.69H860.27V447.645H858.48V446.599H856.689V445.553H855.794V444.507H854.004V443.461H853.109V442.415H851.318V441.369H850.423V440.323H849.528V439.277H848.633V438.231H847.738V437.186H845.947V436.14H845.052V434.048H844.157V433.002H843.262V431.956H842.366V430.91H841.471V428.818H840.576V427.772H839.681V425.681H838.786V423.589H837.891V421.497H836.995V418.359H836.1V414.176H835.205V408.946H834.31V399.533H833.415V337.825H834.31V330.504H835.205V325.274H836.1V322.137H836.995V318.999H837.891V315.861H838.786V313.77H839.681V311.678H840.576V309.586H841.471V308.54H842.366V307.494H843.262V305.402H844.157V304.356H845.052V303.311H845.947V302.265H846.842V301.219H847.738V300.173H848.633V299.127H849.528V298.081H850.423V297.035H851.318V295.989H853.109V294.943H854.004V293.897H855.794V292.852H856.689V291.806H858.48V290.76H860.27V289.714H862.956V288.668H865.641V287.622H867.432V286.576H871.012V285.53H877.279V284.484Z" fill="black"/>
<path d="M281.087 617.08H344.645V627.539H319.58V628.585H318.685V682.972H307.047V627.539H281.087V617.08Z" fill="black"/>
<path d="M351.807 617.08H410.889V627.539H363.444V644.273H409.993V655.778H363.444V671.467H405.518V672.513H410.889V682.972H351.807V617.08Z" fill="black"/>
<path d="M427.897 617.08H478.027V627.539H437.744V628.585H433.268V629.631H432.373V630.677H431.478V669.375H432.373V670.421H433.268V671.467H478.027V682.972H430.583V681.926H427.002V680.88H424.316V679.834H423.421V678.788H422.526V677.742H421.631V676.696H420.736V675.65H419.84V672.513H418.945V628.585H419.84V624.401H420.736V623.355H421.631V621.264H422.526V620.218H423.421V619.172H425.212V618.126H427.897V617.08Z" fill="black"/>
<path d="M486.084 617.08H496.826V619.172H497.721V644.273H537.109V617.08H548.747V682.972H538.005V672.513H537.109V671.467H538.005V661.008H537.109V655.778H497.721V680.88H496.826V682.972H486.084V662.054H485.189V642.182H486.084V617.08Z" fill="black"/>
<path d="M556.803 617.08H566.65V618.126H567.546V619.172H568.441V620.218H569.336V621.264H570.231V622.31H571.126V623.355H572.021V624.401H572.917V625.447H573.812V626.493H574.707V627.539H575.602V628.585H576.497V629.631H577.393V630.677H578.288V631.723H579.183V632.769H580.078V633.814H580.973V634.86H581.868V635.906H582.764V636.952H583.659V637.998H584.554V639.044H585.449V640.09H586.344V641.136H587.24V642.182H589.03V643.228H589.925V644.273H590.82V645.319H591.715V646.365H592.611V647.411H593.506V648.457H594.401V649.503H595.296V650.549H596.191V651.595H597.087V652.641H597.982V653.687H598.877V654.732H599.772V655.778H600.667V656.824H601.562V657.87H602.458V658.916H603.353V659.962H604.248V661.008H605.143V662.054H606.934V664.146H608.724V617.08H618.571V682.972H609.619V681.926H608.724V680.88H607.829V679.834H606.934V678.788H606.038V677.742H605.143V676.696H604.248V675.65H602.458V674.604H601.562V673.559H600.667V671.467H598.877V670.421H597.982V669.375H597.087V668.329H596.191V667.283H595.296V666.237H594.401V665.191H593.506V664.146H592.611V663.1H591.715V662.054H590.82V661.008H589.925V659.962H589.03V658.916H588.135V657.87H587.24V656.824H586.344V655.778H585.449V654.732H584.554V653.687H582.764V652.641H581.868V651.595H580.973V650.549H580.078V649.503H579.183V648.457H578.288V647.411H577.393V646.365H576.497V645.319H575.602V644.273H574.707V643.228H573.812V642.182H572.917V641.136H572.021V640.09H571.126V639.044H570.231V637.998H569.336V636.952H568.441V635.906H567.546V682.972H556.803V617.08Z" fill="black"/>
<path d="M636.475 617.08H680.339V618.126H682.129V619.172H683.919V620.218H685.71V621.264H686.605V622.31H687.5V624.401H688.395V626.493H689.29V630.677H690.186V667.283H689.29V673.559H688.395V675.65H687.5V676.696H686.605V677.742H685.71V678.788H684.814V679.834H683.024V680.88H681.234V681.926H678.548V682.972H637.37V681.926H633.789V680.88H631.999V679.834H630.208V678.788H629.313V677.742H628.418V676.696H627.523V674.604H626.628V670.421H625.732V630.677H626.628V626.493H627.523V624.401H628.418V623.355H629.313V621.264H630.208V620.218H631.999V619.172H633.789V618.126H636.475V617.08ZM642.741 627.539V628.585H640.055V629.631H639.16V630.677H638.265V631.723H637.37V667.283H638.265V669.375H639.16V670.421H640.055V671.467H674.967V670.421H676.758V668.329H677.653V666.237H678.548V631.723H677.653V630.677H676.758V629.631H675.863V628.585H669.596V627.539H666.016V628.585H654.378V627.539H642.741Z" fill="black"/>
<path d="M697.347 617.08H708.984V670.421H709.88V671.467H754.639V672.513H755.534V678.788H754.639V682.972H698.242V676.696H697.347V617.08Z" fill="black"/>
<path d="M769.857 617.08H814.616V618.126H816.406V619.172H818.197V620.218H819.092V621.264H819.987V622.31H820.882V623.355H821.777V624.401H822.673V626.493H823.568V630.677H824.463V655.778H823.568V666.237H824.463V667.283H823.568V673.559H822.673V675.65H821.777V676.696H820.882V677.742H819.987V678.788H819.092V679.834H818.197V680.88H815.511V681.926H811.93V682.972H771.647V681.926H768.066V680.88H766.276V679.834H765.381V678.788H764.486V677.742H763.59V676.696H762.695V675.65H761.8V673.559H760.905V668.329H760.01V629.631H760.905V626.493H761.8V624.401H762.695V622.31H763.59V621.264H764.486V620.218H766.276V619.172H768.066V618.126H769.857V617.08ZM777.018 627.539V628.585H774.333V629.631H773.438V630.677H772.542V632.769H771.647V667.283H772.542V669.375H773.438V670.421H774.333V671.467H809.245V670.421H811.035V669.375H811.93V666.237H812.826V634.86H811.93V630.677H811.035V629.631H810.14V628.585H808.35V627.539H791.341V628.585H781.494V627.539H780.599V628.585H777.913V627.539H777.018Z" fill="black"/>
<path d="M838.786 617.08H892.497V627.539H847.738V628.585H845.052V629.631H843.262V630.677H842.366V668.329H843.262V669.375H844.157V670.421H845.052V671.467H879.069V670.421H879.964V669.375H880.859V656.824H881.755V655.778H880.859V654.732H872.803V655.778H861.165V654.732H860.27V644.273H892.497V673.559H891.602V675.65H890.706V677.742H889.811V678.788H888.916V679.834H888.021V680.88H886.23V681.926H881.755V682.972H842.366V681.926H838.786V680.88H836.995V679.834H835.205V678.788H834.31V677.742H833.415V676.696H832.519V675.65H831.624V672.513H830.729V627.539H831.624V624.401H832.519V622.31H833.415V621.264H834.31V620.218H835.205V619.172H836.995V618.126H838.786V617.08Z" fill="black"/>
<path d="M948.893 616.034H951.579V617.08H955.16V627.539H933.675V657.87H932.78V671.467H955.16V682.972H900.553V671.467H921.143V667.283H922.038V628.585H921.143V627.539H900.553V618.126H899.658V617.08H948.893V616.034Z" fill="black"/>
<path d="M961.426 617.08H1019.61V627.539H973.063V644.273H1019.61V654.732H1018.72V655.778H973.063V671.467H1019.61V672.513H1020.51V682.972H961.426V617.08Z" fill="black"/>
<path d="M1033.94 617.08H1084.07V627.539H1040.2V628.585H1038.41V629.631H1037.52V642.182H1038.41V643.228H1040.2V644.273H1076.9V645.319H1079.59V646.365H1081.38V647.411H1082.28V648.457H1084.07V650.549H1084.96V652.641H1085.86V673.559H1084.96V675.65H1084.07V677.742H1083.17V678.788H1082.28V679.834H1080.49V680.88H1078.69V681.926H1075.11V682.972H1026.77V671.467H1072.43V670.421H1073.32V669.375H1074.22V656.824H1073.32V655.778H1071.53V654.732H1033.04V653.687H1031.25V652.641H1029.46V651.595H1028.56V650.549H1027.67V649.503H1026.77V647.411H1025.88V627.539H1026.77V624.401H1027.67V622.31H1028.56V621.264H1029.46V620.218H1030.35V619.172H1032.15V618.126H1033.94V617.08Z" fill="black"/>
</svg>
      </div>

      <button
        className="cs-header__toggle"
        onClick={() => setMenuOpen(!menuOpen)}
        aria-label="Toggle menu"
      >
        â˜°
      </button>

      <nav className={`cs-header__nav ${menuOpen ? "open" : ""}`}>
        <ul>
          {links.map((link, index) => (
            <li key={index}>
              <a href={link.href}>{link.title}</a>
            </li>
          ))}

            {/* âœ… Cart hidden on home */}
          {pathname == "/product" && (
            <li className="cs-cart">
              <Link href="/cart">ðŸ›’ Cart ({count})</Link>
            </li>
          )}
        </ul>
      </nav>
      
    </header>
  );
};

export default Header;
